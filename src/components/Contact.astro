---
import Buttons from "./Buttons.astro";
import IconContact from "./icons/IconContact.astro";
---

<section title="Quienes Somos?" id="Contacto" class="py-5">
  <div class="container mx-auto px-5 xl:px-0">
    <div>
      <h2
        class="flex items-center gap-4 text-2xl sm:text-4xl font-roboto text-neutral-800 mb-2"
      >
        Contacto
        <IconContact
          name="mdi:scale-balance"
          class="text-neutral-800 w-8 h-8 mr-2"
        />
      </h2>
      <div class="w-24 h-[2px] bg-black/60"></div>
      <h2
        class="text-3xl mt-8 sm:text-5xl text-nowrap font-semibold font-roboto text-neutral-800"
      >
        Esperamos tu consulta
      </h2>
    </div>

    <div
      class="grid md:grid-cols-2 grid-cols-1 gap-10 justify-between items-center py-10"
    >
      <form id="contactForm" class="bg-[#e9e7e7] p-6 shadow-md">
        <label for="name" class="font-roboto">Nombre</label>
        <input
          type="text"
          id="name"
          name="name"
          class="w-full mt-2 p-2 border border-gray-300 rounded mb-4"
          placeholder="Tu Nombre y Apellido"
          required
        />
        <label for="mail" class="font-roboto">Email</label>
        <input
          type="email"
          id="mail"
          name="mail"
          class="w-full mt-2 p-2 border border-gray-300 rounded mb-4"
          placeholder="Tu Gmail Ej: correo@gmail.com"
          required
        />
        <label for="message" class="font-roboto">Consulta</label>
        <textarea
          id="message"
          name="message"
          class="w-full mt-2 p-2 border border-gray-300 rounded mb-4"
          placeholder="Ingresa tu consulta aquí"
          required></textarea>
        <button
          type="submit"
          aria-label="Enviar consulta"
          class="bg-yellow-700 w-full hover:bg-yellow-800 text-white py-3 font-light font-roboto transition-colors"
          >Enviar</button
        >
        <p id="responseMessage" class="mt-2 text-sm text-green-600"></p>
      </form>
      <!-- <div class="w-full h-[408px] shadow-md">
        <iframe
          title="Mapa de Ubicación"
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2815.5786180188875!2d-60.651826950759286!3d-32.94292627380829!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x95b7ab407fe6f715%3A0x4d8a6076f6d87e0d!2sFacultad%20de%20Derecho!5e0!3m2!1ses!2sar!4v1748539567921!5m2!1ses!2sar"
          class="w-full h-full"
          allowfullscreen=""
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div> -->
      <img
        src="/maps.webp"
        alt="Mapa de Ubicación"
        class="w-full h-full shadow-md"
      />
    </div>
  </div>
</section>
<script>
  document
    .querySelector("#contactForm")
    ?.addEventListener("submit", async (e) => {
      e.preventDefault();

      const form = e.target as HTMLFormElement;
      const formData = new FormData(form);
      const res = await fetch("/api/contact", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          name: formData.get("name"),
          mail: formData.get("mail"),
          message: formData.get("message"),
        }),
      });

      const result = await res.json();

      const messageEl = document.getElementById("responseMessage");

      if (result.success) {
        messageEl!.textContent = "Consulta enviado con éxito!!";
        form.reset();
        setTimeout(() => {
          messageEl!.textContent = "";
        }, 3000); // Limpiar mensaje después de 5 segundos
      } else {
        messageEl!.textContent =
          result.message || "Hubo un error al enviar el mensaje.";
      }
    });
</script>
